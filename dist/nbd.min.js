!function(root){var requirejs,require,define;!function(a){function b(a,b){return r.call(a,b)}function c(a,b){var c,d,e,f,g,h,i,j,k,l,m=b&&b.split("/"),n=p.map,o=n&&n["*"]||{};if(a&&"."===a.charAt(0))if(b){for(m=m.slice(0,m.length-1),a=m.concat(a.split("/")),j=0;j<a.length;j+=1)if(l=a[j],"."===l)a.splice(j,1),j-=1;else if(".."===l){if(1===j&&(".."===a[2]||".."===a[0]))break;j>0&&(a.splice(j-1,2),j-=2)}a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((m||o)&&n){for(c=a.split("/"),j=c.length;j>0;j-=1){if(d=c.slice(0,j).join("/"),m)for(k=m.length;k>0;k-=1)if(e=n[m.slice(0,k).join("/")],e&&(e=e[d])){f=e,g=j;break}if(f)break;!h&&o&&o[d]&&(h=o[d],i=j)}!f&&h&&(f=h,g=i),f&&(c.splice(0,g,f),a=c.join("/"))}return a}function d(b,c){return function(){return k.apply(a,s.call(arguments,0).concat([b,c]))}}function e(a){return function(b){return c(b,a)}}function f(a){return function(b){n[a]=b}}function g(c){if(b(o,c)){var d=o[c];delete o[c],q[c]=!0,j.apply(a,d)}if(!b(n,c)&&!b(q,c))throw new Error("No "+c);return n[c]}function h(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function i(a){return function(){return p&&p.config&&p.config[a]||{}}}var j,k,l,m,n={},o={},p={},q={},r=Object.prototype.hasOwnProperty,s=[].slice;l=function(a,b){var d,f=h(a),i=f[0];return a=f[1],i&&(i=c(i,b),d=g(i)),i?a=d&&d.normalize?d.normalize(a,e(b)):c(a,b):(a=c(a,b),f=h(a),i=f[0],a=f[1],i&&(d=g(i))),{f:i?i+"!"+a:a,n:a,pr:i,p:d}},m={require:function(a){return d(a)},exports:function(a){var b=n[a];return"undefined"!=typeof b?b:n[a]={}},module:function(a){return{id:a,uri:"",exports:n[a],config:i(a)}}},j=function(c,e,h,i){var j,k,p,r,s,t,u=[];if(i=i||c,"function"==typeof h){for(e=!e.length&&h.length?["require","exports","module"]:e,s=0;s<e.length;s+=1)if(r=l(e[s],i),k=r.f,"require"===k)u[s]=m.require(c);else if("exports"===k)u[s]=m.exports(c),t=!0;else if("module"===k)j=u[s]=m.module(c);else if(b(n,k)||b(o,k)||b(q,k))u[s]=g(k);else{if(!r.p)throw new Error(c+" missing "+k);r.p.load(r.n,d(i,!0),f(k),{}),u[s]=n[k]}p=h.apply(n[c],u),c&&(j&&j.exports!==a&&j.exports!==n[c]?n[c]=j.exports:p===a&&t||(n[c]=p))}else c&&(n[c]=h)},requirejs=require=k=function(b,c,d,e,f){return"string"==typeof b?m[b]?m[b](c):g(l(b,c).f):(b.splice||(p=b,c.splice?(b=c,c=d,d=null):b=a),c=c||function(){},"function"==typeof d&&(d=e,e=f),e?j(a,b,c,d):setTimeout(function(){j(a,b,c,d)},4),k)},k.config=function(a){return p=a,p.deps&&k(p.deps,p.callback),k},define=function(a,c,d){c.splice||(d=c,c=[]),b(n,a)||b(o,a)||(o[a]=[a,c,d])},define.amd={jQuery:!0}}(),define("node_modules/almond/almond",function(){}),define("nbd/Class",[],function(){"use strict";var a,b,c,d=function(){},e=/xyz/.test(function(){return xyz})?/\b_super\b/:/.*/;return b=function(a){var b={};return Object.keys(a).forEach(function(c){b[c]={configurable:!0,writable:!0,enumerable:!1,value:a[c]}}),Object.defineProperties(this.prototype,b),this},c=function(a){var b,c=!1;if("function"==typeof a)return a.prototype.isPrototypeOf(this.prototype);if("object"==typeof a){c=!0;for(b in a)if(a.hasOwnProperty(b)&&a[b]!==this.prototype[b]){c=!1;break}}return c},a=function(d,f){function g(a,b){var c=function(){return i[a].apply(this,arguments)};return function(){var a=this.hasOwnProperty("_super"),d=this._super;this._super=c;try{return b.apply(this,arguments)}catch(e){throw e}finally{a&&(this._super=d)}}}function h(){"function"==typeof this.init&&this.init.apply(this,arguments)}var i=this.prototype,j=function(a){h[a]=this[a]},k=Object.create(i);return d=d||{},f=f||{},Object.keys(d).forEach(function(a){var b=d[a];k[a]="function"==typeof b&&"function"==typeof i[a]&&e.test(b)?g(a,b):b}),Object.keys(this).forEach(j,this),Object.keys(f).forEach(j,f),h.prototype=k,Object.defineProperty(h.prototype,"constructor",{value:h}),Object.defineProperties(h,{extend:{value:a,enumerable:!1},mixin:{value:b},inherits:{value:c}}),h},d.extend=a,d}),define("nbd/util/async",[],function(){"use strict";function canUseNextTick(){return"object"==typeof process&&"[object process]"===Object.prototype.toString.call(process)}function canUseMessageChannel(){return!!global.MessageChannel}function canUsePostMessage(){if(!global.postMessage||global.importScripts)return!1;var a=!0,b=global.onmessage;return global.onmessage=function(){a=!1},global.postMessage("","*"),global.onmessage=b,a}function canUseReadyStateChange(){return"document"in global&&"onreadystatechange"in global.document.createElement("script")}function nextTickImplementation(){return function(){var a=tasks.addFromSetImmediateArguments(arguments);return process.nextTick(function(){tasks.runIfPresent(a)}),a}}function messageChannelImplementation(){var a=new global.MessageChannel;return a.port1.onmessage=function(a){var b=a.data;tasks.runIfPresent(b)},function(){var b=tasks.addFromSetImmediateArguments(arguments);return a.port2.postMessage(b),b}}function postMessageImplementation(){function a(a,b){return"string"==typeof a&&a.substring(0,b.length)===b}function b(b){if(b.source===global&&a(b.data,c)){var d=b.data.substring(c.length);tasks.runIfPresent(d)}}var c="async-message"+Math.random();return global.addEventListener?global.addEventListener("message",b,!1):global.attachEvent("onmessage",b),function(){var a=tasks.addFromSetImmediateArguments(arguments);return global.postMessage(c+a,"*"),a}}function readyStateChangeImplementation(){return function(){var a=tasks.addFromSetImmediateArguments(arguments),b=global.document.createElement("script");return b.onreadystatechange=function(){tasks.runIfPresent(a),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},global.document.documentElement.appendChild(b),a}}function setTimeoutImplementation(){return function(){var a=tasks.addFromSetImmediateArguments(arguments);return global.setTimeout(function(){tasks.runIfPresent(a)},0),a}}var global="undefined"!=typeof global?global:"undefined"!=typeof window?window:this,async,tasks=function(){function Task(a,b){this.handler=a,this.args=b}Task.prototype.run=function(){if("function"==typeof this.handler)this.handler.apply(void 0,this.args);else{var scriptSource=""+this.handler;eval(scriptSource)}};var nextHandle=1,tasksByHandle={},currentlyRunningATask=!1;return{addFromSetImmediateArguments:function(a){var b=a[0],c=Array.prototype.slice.call(a,1),d=new Task(b,c),e=nextHandle++;return tasksByHandle[e]=d,e},runIfPresent:function(a){if(currentlyRunningATask)global.setTimeout(function(){tasks.runIfPresent(a)},0);else{var b=tasksByHandle[a];if(b){currentlyRunningATask=!0;try{b.run()}finally{delete tasksByHandle[a],currentlyRunningATask=!1}}}},remove:function(a){delete tasksByHandle[a]}}}();return global.setImmediate?async=global.setImmediate:(async=canUseNextTick()?nextTickImplementation():canUsePostMessage()?postMessageImplementation():canUseMessageChannel()?messageChannelImplementation():canUseReadyStateChange()?readyStateChangeImplementation():setTimeoutImplementation(),async.clearImmediate=tasks.remove),async}),define("nbd/util/extend",[],function(){"use strict";return function(a){var b,c,d;for(b=1;b<arguments.length;++b){d=arguments[b];for(c in d)a[c]=d[c]}return a}}),define("nbd/util/diff",["./extend"],function(a){"use strict";function b(a,d){var e,f=!0;if(Object.getPrototypeOf(a)!==Object.prototype||Object.getPrototypeOf(d)!==Object.prototype)return!1;for(e in a){if(a[e]!==d[e])return!1;if(a.hasOwnProperty(e)&&"object"==typeof a[e]&&a[e]&&Object.getPrototypeOf(a[e])===Object.prototype){if(~c.indexOf(a[e]))continue;try{c.push(a[e]),f=f&&b(d[e],a[e])}catch(g){}finally{c.pop()}}if(!f)return f}return f}var c=[];return function(c,d,e){var f,g,h,i={};if("object"!=typeof d||"object"!=typeof c||null===d||null===c)throw new TypeError("Arguments must be objects");d=a({},d);for(f in c)if(c.hasOwnProperty(f)){if(g=c[f],h=d[f],delete d[f],g===h)continue;"object"==typeof g&&"object"==typeof h&&g&&h&&b(g,h)||(i[f]=[g,h],e&&e.apply(this,[f,g,h]))}for(f in d)d.hasOwnProperty(f)&&void 0!==d[f]&&(i[f]=[c[f]],e&&e.apply(this,[f,void 0,d[f]]));return i}}),define("nbd/trait/pubsub",[],function(){"use strict";var a=/\s+/,b=function c(a){return c.i=c.i||0,(a||"")+ ++c.i};return{on:function(b,c,d){var e,f,g;if(!c)return this;for(b=b.split(a),this._callbacks||Object.defineProperty(this,"_callbacks",{configurable:!0,value:{},writable:!0}),e=this._callbacks;f=b.shift();)g=e[f]||(e[f]=[]),g.push(c,d);return this},off:function(b,c,d){var e,f,g,h;if(!(f=this._callbacks))return this;if(!(b||c||d))return delete this._callbacks,this;for(b=b?b.split(a):Object.keys(f);e=b.shift();)if((g=f[e])&&(c||d))for(h=g.length-2;h>=0;h-=2)c&&g[h]!==c||d&&g[h+1]!==d||g.splice(h,2);else delete f[e];return this},trigger:function(b){var c,d,e,f,g,h,i,j;if(!(d=this._callbacks))return this;for(j=[],b=b.split(a),f=1,g=arguments.length;g>f;f++)j[f-1]=arguments[f];for(;c=b.shift();){if((i=d.all)&&(i=i.slice()),(e=d[c])&&(e=e.slice()),e)for(f=0,g=e.length;g>f;f+=2)e[f].apply(e[f+1]||this,j);if(i)for(h=[c].concat(j),f=0,g=i.length;g>f;f+=2)i[f].apply(i[f+1]||this,h)}return this},listenTo:function(a,c,d){var e=this._listeners||(this._listeners={}),f=a._listenerId||(a._listenerId=b("l"));return e[f]=a,a.on(c,d||this,this),this},stopListening:function(a,b,c){var d=this._listeners;if(d){if(a)a.off(b,c,this),b||c||delete d[a._listenerId];else{for(var e in d)d[e].off(null,null,this);this._listeners={}}return this}}}}),define("nbd/Model",["./Class","./util/async","./util/extend","./util/diff","./trait/pubsub"],function(a,b,c,d,e){"use strict";var f=function(a,b){this._dirty&&a&&(d.call(this,b||this._data,a,this.trigger),this._dirty=0)},g=a.extend({init:function(a,b){"string"==typeof a&&a.match(/^\d+$/)&&(a=+a),void 0===b&&"object"==typeof a&&(b=a,a=void 0),this.id=function(){return a};try{Object.defineProperty(this,"_dirty",{value:0,writable:!0}),Object.defineProperty(this,"_data",{enumerable:!1,configurable:!0,value:b||{},writable:!0})}catch(c){this._dirty=0,this._data=b}},destroy:function(){this.off(),this._data=null},data:function(){return this._dirty!==!0&&(b(f.bind(this,c({},this._data,this._dirty||void 0))),this._dirty=!0),this._data},get:function(a){return this._data[a]},set:function(a,b){var c,d=this.data();if("string"==typeof a)return this._dirty!==!0&&(this._dirty=this._dirty||{},c in this._dirty||(this._dirty[a]=d[a])),d[a]=b,this;if("object"==typeof a){for(c in a)a.hasOwnProperty(c)&&(this._dirty!==!0&&(this._dirty=this._dirty||{},c in this._dirty||(this._dirty[c]=d[c])),d[c]=a[c]);return this}},toJSON:function(){return this._data}}).mixin(e);return g}),define("nbd/View",["./Class","./trait/pubsub"],function(a,b){"use strict";var c=a.extend({$view:null,render:function(a){var b=this.$view;return this.trigger("prerender",b),this.$view=this.template(a||this.templateData()),b&&b.length&&b.replaceWith(this.$view),this.trigger("postrender",this.$view),this.rendered&&this.rendered(this.$view),this.$view},template:function(){},templateData:function(){return{}},destroy:function(){this.$view&&this.$view.remove&&this.$view.remove(),this.$view=null,this.off()}}).mixin(b);return c}),define("nbd/View/Entity",["../View"],function(a){"use strict";var b=a.extend({init:function(a){"object"==typeof a&&(this._model=this.Model=a),this.id=a&&a.id||function(){return a}},destroy:function(a){this._model.off(null,null,this),a||(this._model=this.Model=null),this._super()},templateData:function(){return this._model&&this._model.data?this._model.data():this.id()},render:function(a){var b=this.$view,c=!(b&&a);return c&&(this.trigger("prerender",b),this.$view=this.template(this.templateData())),a?this.$view&&this.$view.appendTo(a):b&&b.replaceWith(this.$view),c&&(this.trigger("postrender",this.$view),"function"==typeof this.rendered&&this.rendered(this.$view)),this.$view}});return b}),define("nbd/View/Element",["../View"],function(a){"use strict";var b=a.extend({$parent:null,init:function(a){this.$parent=a},render:function(a){var b=this.$view;return this.trigger("prerender",b),this.$view=this.template(a||this.templateData()),b&&b.length?b.replaceWith(this.$view):this.$view.appendTo(this.$parent),this.trigger("postrender",this.$view),this.rendered&&this.rendered(this.$view),this.$view}});return b}),define("nbd/util/construct",[],function(){"use strict";var a=Object.prototype.toString;return function(){if(!~a.call(this).indexOf("Function"))throw new TypeError("construct called on incompatible Object");var b=Object.create(this.prototype),c=this.apply(b,arguments);return Object(c)===c?c:b}}),define("nbd/Controller",["./Class","./util/construct"],function(a,b){"use strict";var c=a.extend({destroy:function(){},_initView:function(a){var c=Array.prototype.slice.call(arguments,1);this._view=this.View=b.apply(a,c),this._view._controller=this._view.Controller=this},switchView:function(){var a=this._view;this._initView.apply(this,arguments),a&&(a.$view&&(this._view.$view=a.$view,this._view.render()),a.destroy())}});return c}),define("nbd/Controller/Entity",["../util/construct","../Controller","../View/Entity","../Model"],function(a,b,c,d){"use strict";var e=b.extend({init:function(){this._model=this.Model=a.apply(this.constructor.MODEL_CLASS,arguments),this._initView(this.constructor.VIEW_CLASS,this._model)},render:function(a,b){b=b||this.constructor.VIEW_CLASS,this.requestView(b),this._view.render(a)},destroy:function(){this._view.destroy(),this._model.destroy(),this._model=this._view=null},requestView:function(a){this._view instanceof a||this.switchView(a,this._model)}},{VIEW_CLASS:c,MODEL_CLASS:d});return e}),define("nbd/event",["./util/extend","./trait/pubsub"],function(a,b){"use strict";var c=a({},b);return c.bind=c.on,c.unbind=c.off,c.fire=c.trigger,c}),define("nbd/trait/promise",["../util/async","../util/extend"],function(a,b){"use strict";function c(){function b(b){b.length&&a(function(){for(var a=0;a<b.length;++a)b[a](h)}),j=k=[]}function d(a){l||(l=1,h=a,b(j))}function e(a){l||(l=-1,h=a,b(k))}function f(a){if(a===i&&e(new TypeError("Cannot resolve with self")),a instanceof c)return a.then(f,e),void 0;if(("object"==typeof a||"function"==typeof a)&&null!==a){var b;try{b=a.then}catch(g){return e(g),void 0}if("function"==typeof b)return function(){var c=!1;try{b.call(a,function(b){c||((b===a?d:f)(b),c=!0)},function(a){c||(e(a),c=!0)})}catch(g){c||e(g)}}()}d(a)}function g(b,d){function e(a){return function(b){var c;try{c=a(b)}catch(d){f.reject(d)}f.resolve(c)}}var f=new c;if(l){var g=l>0?b:d;"function"==typeof g?(g=e(g),a(function(){g(h)})):f[l>0?"resolve":"reject"](h)}else j.push("function"==typeof b?e(b):f.resolve),k.push("function"==typeof d?e(d):f.reject);return f}var h,i=this,j=[],k=[],l=0;Object.defineProperties(this,{reject:{value:e},resolve:{value:f}}),this.then=g}c.prototype.thenable=function(){return{then:this.then}},c.prototype.promise=function(){var a=this.then,b=function(){return c},c={done:function(){var b=Array.prototype.concat.apply([],arguments);return b.forEach(function(b){a(b)}),c},fail:function(){var b=Array.prototype.concat.apply([],arguments);return b.forEach(function(b){a(void 0,b)}),c},then:a,progress:b,promise:b};return c};var d=function(){this._promise||Object.defineProperty(this,"_promise",{value:new c})};return b(c,{then:function(a,b){return d.call(this),this._promise.then(a,b)},resolve:function(a){return d.call(this),this._promise.resolve(a),this},reject:function(a){return d.call(this),this._promise.reject(a),this},thenable:function(){return d.call(this),this._promise.thenable()},promise:function(){return d.call(this),this._promise.promise()}}),c}),define("nbd/util/deparam",[],function(){"use strict";return function(a,b){var c={},d={"true":!0,"false":!1,"null":null};return a.replace(/\+/g," ").split("&").forEach(function(a){var e,f=a.split("="),g=decodeURIComponent(f[0]),h=c,i=0,j=g.split("]["),k=j.length-1;if(/\[/.test(j[0])&&/\]$/.test(j[k])?(j[k]=j[k].replace(/\]$/,""),j=j.shift().split("[").concat(j),k=j.length-1):k=0,2===f.length)if(e=decodeURIComponent(f[1]),b&&(e=e&&!isNaN(e)?+e:"undefined"===e?void 0:void 0!==d[e]?d[e]:e),k)for(i;k>=i;i++)g=""===j[i]?h.length:j[i],h=h[g]=k>i?h[g]||(j[i+1]&&isNaN(j[i+1])?{}:[]):e;else Array.isArray(c[g])?c[g].push(e):c[g]=void 0!==c[g]?[c[g],e]:e;else g&&(c[g]=b?void 0:"")}),c}}),define("nbd/util/media",["./extend","../trait/pubsub"],function(a,b){"use strict";function c(a,b){var c;(c=g[a])&&c.removeListener(c.listener),c=h(b),c.listener=f.bind(c,a),c.addListener(c.listener),g[a]=c,c.matches&&f.call(c,a)}function d(a){return g[a]&&g[a].matches}function e(a,b){var d;if(!h)throw new Error("Media queries not supported.");if("string"==typeof a)return c(a,b),e;if("object"==typeof a)for(d in a)a.hasOwnProperty(d)&&(b=a[d],c(d,b));return e}var f,g={},h="undefined"!=typeof matchMedia?matchMedia:"undefined"!=typeof msMatchMedia?msMatchMedia:null;return a(e,b),f=function(a){e.trigger(a+(this.matches?":enter":":exit")),e.trigger(a,this.matches)},e.is=d,e.getState=function(a){return a?d(a):Object.keys(g).filter(d)},e}),define("nbd/util/pipe",[],function(){"use strict";return function(){var a=arguments;return function(){var b,c;for(b=0;b<a.length;++b)c=a[b].apply(this,0===b?arguments:[c]);return c}}}),define("nbd/util/when",["../trait/promise"],function(a){"use strict";var b=function(){return this};return function(){function c(a,b){h[a]=b}var d,e,f,g=new a,h=[];for(e=0;e<arguments.length;++e)arguments[e]instanceof a?d=arguments[e]:(d=new a,d.resolve(arguments[e])),d.then(c.bind(null,e)),f=f?f.then(b.bind(d)):d;return arguments.length?f.then(g.resolve.bind(null,h),g.reject):g.resolve(h),g}}),define("build/all",["nbd/Class","nbd/Model","nbd/View","nbd/View/Entity","nbd/View/Element","nbd/Controller","nbd/Controller/Entity","nbd/event","nbd/trait/promise","nbd/trait/pubsub","nbd/util/async","nbd/util/construct","nbd/util/deparam","nbd/util/diff","nbd/util/extend","nbd/util/media","nbd/util/pipe","nbd/util/when"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){"use strict";var s={Class:a,Model:b,View:c,Controller:f,event:h,trait:{promise:i,pubsub:j},util:{async:k,construct:l,deparam:m,diff:n,extend:o,media:p,pipe:q,when:r}};return s.View.Element=e,s.View.Entity=d,s.Controller.Entity=g,s}),root.nbd=require("build/all")}(this);